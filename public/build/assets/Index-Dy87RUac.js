import{K as O,r as s,j as a,L as U,S as $}from"./app-BRYc7fcH.js";import{B as k}from"./button-62sCmGqE.js";import{C as u,a as g,b as p,c as j}from"./card-CfsX1XbZ.js";import{I as N}from"./input-Bgte7pU7.js";import{L as f}from"./label-CoxH2Qfm.js";import{T as q,a as J,b as T,c as o,d as z,e as c}from"./table-CQ0rEgZh.js";import{f as b}from"./utils-bKZ1P-RO.js";import{A as G}from"./app-layout-D2kuovJF.js";import{S as _,a as C,b as P,c as L,d as l}from"./select-AYxIQsxd.js";import{A as D}from"./arrow-up-down-BvKjbisY.js";import"./index-Cy8j_I1h.js";import"./index-DJGy6dgq.js";import"./index-CuURWILg.js";import"./index-3-Li-IYw.js";import"./avatar-5NFhio4q.js";import"./log-out-B3ILwOSN.js";import"./jayanusa-DK0lkaAg.js";const Q=[{title:"Laporan",href:"/laporan"}],W=r=>{switch(r){case"dibayar":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"menunggu":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"ditolak":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}};function ua(){const{flash:r}=O().props,[n,A]=s.useState(""),[i,I]=s.useState(""),[m,F]=s.useState("all"),[h,E]=s.useState("all"),[S,M]=s.useState([]),[v,R]=s.useState(0),[y,B]=s.useState(0);s.useEffect(()=>{r!=null&&r.data&&(M(r.data.data),R(r.data.total),B(r.data.total_siswa))},[r]);const K=e=>{if(e.preventDefault(),!n||!i){alert("Mohon isi tanggal awal dan akhir");return}$.post("/laporan/periode",{tanggal_awal:n,tanggal_akhir:i,status:m,program_studi:h},{preserveState:!0,preserveScroll:!0,onError:t=>{console.error(t),alert("Terjadi kesalahan saat memuat data")},onSuccess:()=>{const t=new URLSearchParams;t.set("tanggal_awal",n),t.set("tanggal_akhir",i),t.set("status",m),t.set("program_studi",h),window.history.pushState({},"",`/laporan/periode?${t.toString()}`)}})},H=()=>{var w;if(!n||!i){alert("Mohon isi tanggal awal dan akhir");return}const e=document.createElement("form");e.method="POST",e.action="/laporan/download-pdf";const t=(w=document.querySelector('meta[name="csrf-token"]'))==null?void 0:w.getAttribute("content");if(t){const d=document.createElement("input");d.type="hidden",d.name="_token",d.value=t,e.appendChild(d)}for(const[d,V]of Object.entries({tanggal_awal:n,tanggal_akhir:i,status:m,program_studi:h})){const x=document.createElement("input");x.type="hidden",x.name=d,x.value=V,e.appendChild(x)}document.body.appendChild(e),e.submit(),document.body.removeChild(e)};return a.jsxs(G,{breadcrumbs:Q,children:[a.jsx(U,{title:"Laporan Pembayaran"}),a.jsxs("div",{className:"flex h-full flex-1 flex-col space-y-8 p-8",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Laporan Pembayaran"}),a.jsx("p",{className:"text-muted-foreground",children:"Lihat laporan pembayaran berdasarkan periode"})]})}),a.jsxs(u,{className:"mb-6",children:[a.jsx(g,{children:a.jsx(p,{children:"Filter Periode"})}),a.jsx(j,{children:a.jsxs("form",{onSubmit:K,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx(f,{htmlFor:"tanggal_awal",children:"Tanggal Awal"}),a.jsx(N,{type:"date",id:"tanggal_awal",value:n,onChange:e=>A(e.target.value),max:i||void 0})]}),a.jsxs("div",{children:[a.jsx(f,{htmlFor:"tanggal_akhir",children:"Tanggal Akhir"}),a.jsx(N,{type:"date",id:"tanggal_akhir",value:i,onChange:e=>I(e.target.value),min:n||void 0})]}),a.jsxs("div",{children:[a.jsx(f,{htmlFor:"status",children:"Status Pembayaran"}),a.jsxs(_,{value:m,onValueChange:F,children:[a.jsx(C,{children:a.jsx(P,{placeholder:"Pilih Status"})}),a.jsxs(L,{children:[a.jsx(l,{value:"all",children:"Semua Status"}),a.jsx(l,{value:"dibayar",children:"Dibayar"}),a.jsx(l,{value:"menunggu",children:"Menunggu"}),a.jsx(l,{value:"ditolak",children:"Ditolak"})]})]})]}),a.jsxs("div",{children:[a.jsx(f,{htmlFor:"program_studi",children:"Program Studi"}),a.jsxs(_,{value:h,onValueChange:E,children:[a.jsx(C,{children:a.jsx(P,{placeholder:"Pilih Program Studi"})}),a.jsxs(L,{children:[a.jsx(l,{value:"all",children:"Semua Program Studi"}),a.jsx(l,{value:"MI",children:"D3-Manajemen Informatika"}),a.jsx(l,{value:"SI",children:"S1-Sistem Informasi"}),a.jsx(l,{value:"SK",children:"S1-Sistem Komputer"})]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(k,{type:"submit",children:"Tampilkan Laporan"}),a.jsx(k,{type:"button",variant:"outline",onClick:H,children:"Download PDF"})]})]})})]}),S.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs(u,{children:[a.jsx(g,{children:a.jsx(p,{className:"text-sm font-medium",children:"Total Pembayaran"})}),a.jsx(j,{children:a.jsx("div",{className:"text-2xl font-bold",children:b(v)})})]}),a.jsxs(u,{children:[a.jsx(g,{children:a.jsx(p,{className:"text-sm font-medium",children:"Total Siswa"})}),a.jsx(j,{children:a.jsxs("div",{className:"text-2xl font-bold",children:[y," orang"]})})]}),a.jsxs(u,{children:[a.jsx(g,{children:a.jsx(p,{className:"text-sm font-medium",children:"Rata-rata Pembayaran"})}),a.jsx(j,{children:a.jsx("div",{className:"text-2xl font-bold",children:b(v/y)})})]})]}),a.jsx("div",{className:"rounded-lg border border-gray-200 dark:border-gray-800 overflow-hidden shadow-sm",children:a.jsxs(q,{children:[a.jsx(J,{children:a.jsxs(T,{children:[a.jsx(o,{className:"cursor-pointer hover:text-primary transition-colors",children:a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("span",{children:"Nama Siswa"}),a.jsx(D,{className:"h-4 w-4"})]})}),a.jsx(o,{children:"Kode Pembayaran"}),a.jsx(o,{children:"Jumlah"}),a.jsx(o,{children:"Status"}),a.jsx(o,{className:"cursor-pointer hover:text-primary transition-colors",children:a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("span",{children:"Tanggal"}),a.jsx(D,{className:"h-4 w-4"})]})})]})}),a.jsx(z,{children:S.map(e=>{var t;return a.jsxs(T,{children:[a.jsx(c,{children:(t=e.siswa)==null?void 0:t.nama}),a.jsx(c,{children:e.kode_pembayaran}),a.jsx(c,{children:b(e.jumlah)}),a.jsx(c,{children:a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${W(e.status)}`,children:e.status})}),a.jsx(c,{children:new Date(e.created_at).toLocaleDateString()})]},e.id)})})]})})]})]})]})}export{ua as default};
