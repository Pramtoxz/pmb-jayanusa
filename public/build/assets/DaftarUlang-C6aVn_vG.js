import{K as B,r as i,j as a,L as H,S as V}from"./app-DnymW8wr.js";import{B as f}from"./button-B2Rzikt1.js";import{C as S,a as b,b as v,c as w}from"./card-B6S7EfGE.js";import{I as y}from"./input-BYYIiTuI.js";import{L as g}from"./label-arjF9kf-.js";import{T as O,a as R,b as k,c as m,d as q,e as u}from"./table-C3u9XbbL.js";import{A as $}from"./app-layout-BMcKJ6rY.js";import{S as N,a as T,b as D,c as _,d as s}from"./select-C5mons2W.js";import{A as C}from"./arrow-up-down-BQhCmwBf.js";import"./utils-DfMvvvIU.js";import"./index-DJUGPmWW.js";import"./index-fjz_OlXp.js";import"./index-uiLhbe68.js";import"./index-CYsu8eN4.js";import"./avatar-CG7Xbu_S.js";import"./log-out-BskkBsrY.js";import"./jayanusa-DK0lkaAg.js";const z=[{title:"Laporan Daftar Ulang",href:"/laporan/daftar-ulang"}],G=t=>{switch(t){case"dibayar":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"menunggu":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"ditolak":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}};function ma(){const{flash:t}=B().props,[d,L]=i.useState(""),[o,I]=i.useState(""),[x,P]=i.useState("all"),[p,A]=i.useState("all"),[j,F]=i.useState([]),[E,M]=i.useState(0);i.useEffect(()=>{t!=null&&t.data&&(F(t.data.data),M(t.data.total_siswa))},[t]);const K=e=>{if(e.preventDefault(),!d||!o){alert("Mohon isi tanggal awal dan akhir");return}V.post("/laporan/daftar-ulang",{tanggal_awal:d,tanggal_akhir:o,status:x,program_studi:p},{preserveState:!0,preserveScroll:!0,onError:l=>{console.error(l),alert("Terjadi kesalahan saat memuat data")}})},U=()=>{var c;if(!d||!o){alert("Mohon isi tanggal awal dan akhir");return}const e=document.createElement("form");e.method="POST",e.action="/laporan/daftar-ulang/download-pdf";const l=(c=document.querySelector('meta[name="csrf-token"]'))==null?void 0:c.getAttribute("content");if(l){const r=document.createElement("input");r.type="hidden",r.name="_token",r.value=l,e.appendChild(r)}for(const[r,h]of Object.entries({tanggal_awal:d,tanggal_akhir:o,status:x,program_studi:p})){const n=document.createElement("input");n.type="hidden",n.name=r,n.value=h,e.appendChild(n)}document.body.appendChild(e),e.submit(),document.body.removeChild(e)};return a.jsxs($,{breadcrumbs:z,children:[a.jsx(H,{title:"Laporan Daftar Ulang"}),a.jsxs("div",{className:"flex h-full flex-1 flex-col space-y-8 p-8",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Laporan Daftar Ulang"}),a.jsx("p",{className:"text-muted-foreground",children:"Lihat laporan daftar ulang berdasarkan periode"})]})}),a.jsxs(S,{className:"mb-6",children:[a.jsx(b,{children:a.jsx(v,{children:"Filter Periode"})}),a.jsx(w,{children:a.jsxs("form",{onSubmit:K,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx(g,{htmlFor:"tanggal_awal",children:"Tanggal Awal"}),a.jsx(y,{type:"date",id:"tanggal_awal",value:d,onChange:e=>L(e.target.value),max:o||void 0})]}),a.jsxs("div",{children:[a.jsx(g,{htmlFor:"tanggal_akhir",children:"Tanggal Akhir"}),a.jsx(y,{type:"date",id:"tanggal_akhir",value:o,onChange:e=>I(e.target.value),min:d||void 0})]}),a.jsxs("div",{children:[a.jsx(g,{htmlFor:"status",children:"Status"}),a.jsxs(N,{value:x,onValueChange:P,children:[a.jsx(T,{children:a.jsx(D,{placeholder:"Pilih Status"})}),a.jsxs(_,{children:[a.jsx(s,{value:"all",children:"Semua Status"}),a.jsx(s,{value:"dibayar",children:"Dibayar"}),a.jsx(s,{value:"menunggu",children:"Menunggu"}),a.jsx(s,{value:"ditolak",children:"Ditolak"})]})]})]}),a.jsxs("div",{children:[a.jsx(g,{htmlFor:"program_studi",children:"Program Studi"}),a.jsxs(N,{value:p,onValueChange:A,children:[a.jsx(T,{children:a.jsx(D,{placeholder:"Pilih Program Studi"})}),a.jsxs(_,{children:[a.jsx(s,{value:"all",children:"Semua Program Studi"}),a.jsx(s,{value:"MI",children:"D3-Manajemen Informatika"}),a.jsx(s,{value:"SI",children:"S1-Sistem Informasi"}),a.jsx(s,{value:"SK",children:"S1-Sistem Komputer"})]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(f,{type:"submit",children:"Tampilkan Laporan"}),a.jsx(f,{type:"button",variant:"outline",onClick:U,children:"Download PDF"})]})]})})]}),j.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid grid-cols-1 gap-4",children:a.jsxs(S,{children:[a.jsx(b,{children:a.jsx(v,{className:"text-sm font-medium",children:"Total Siswa Daftar Ulang"})}),a.jsx(w,{children:a.jsxs("div",{className:"text-2xl font-bold",children:[E," orang"]})})]})}),a.jsx("div",{className:"rounded-lg border border-gray-200 dark:border-gray-800 overflow-hidden shadow-sm",children:a.jsxs(O,{children:[a.jsx(R,{children:a.jsxs(k,{children:[a.jsx(m,{className:"cursor-pointer hover:text-primary transition-colors",children:a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("span",{children:"Nama Siswa"}),a.jsx(C,{className:"h-4 w-4"})]})}),a.jsx(m,{children:"Kode Pembayaran"}),a.jsx(m,{children:"Program Studi"}),a.jsx(m,{children:"Status"}),a.jsx(m,{className:"cursor-pointer hover:text-primary transition-colors",children:a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("span",{children:"Tanggal"}),a.jsx(C,{className:"h-4 w-4"})]})})]})}),a.jsx(q,{children:j.map(e=>{var l,c,r,h,n;return a.jsxs(k,{children:[a.jsx(u,{children:(l=e.siswa)==null?void 0:l.nama}),a.jsx(u,{children:e.kode_pembayaran}),a.jsx(u,{children:((c=e.siswa)==null?void 0:c.program_studi)==="MI"?"D3-Manajemen Informatika":((r=e.siswa)==null?void 0:r.program_studi)==="SI"?"S1-Sistem Informasi":((h=e.siswa)==null?void 0:h.program_studi)==="SK"?"S1-Sistem Komputer":(n=e.siswa)==null?void 0:n.program_studi}),a.jsx(u,{children:a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${G(e.status)}`,children:e.status})}),a.jsx(u,{children:new Date(e.created_at).toLocaleDateString()})]},e.id)})})]})})]})]})]})}export{ma as default};
